<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nut Safety Snack Scanner</title>

<!-- Google Font -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">

<style>
    body {
        font-family: 'Inter', sans-serif;
        background: #faf9f4;
        color: #333;
        margin: 0;
        padding: 0;
        line-height: 1.5;
    }

    header {
        background: #f2e59c;
        padding: 20px;
        text-align: center;
        font-size: 1.8rem;
        font-weight: 600;
        border-bottom: 2px solid #e0d58a;
    }

    .container {
        max-width: 800px;
        margin: 30px auto;
        padding: 20px;
    }

    h2 {
        font-weight: 600;
        margin-top: 30px;
        color: #5f5a17;
    }

    button {
        background: #f2e59c;
        padding: 12px 22px;
        border-radius: 8px;
        border: none;
        font-size: 1rem;
        cursor: pointer;
        transition: 0.2s;
        margin-bottom: 20px;
        font-weight: 600;
    }

    button:hover {
        background: #e6d884;
    }

    #webcam-container {
        margin-top: 10px;
    }

    /* Icon legend */
    .legend {
        margin-top: 15px;
        display: flex;
        gap: 20px;
        flex-wrap: wrap;
    }

    .legend-box {
        background: white;
        border-radius: 10px;
        padding: 12px 16px;
        display: flex;
        align-items: center;
        gap: 10px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.08);
    }

    .icon {
        font-size: 1.4rem;
    }

    /* About section box */
    .about-box {
        background: white;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 2px 6px rgba(0,0,0,0.08);
        margin-top: 20px;
    }

    footer {
        text-align: center;
        font-size: 0.85rem;
        color: #777;
        margin-top: 30px;
        padding-bottom: 20px;
    }
</style>
</head>

<body>

<header>Nut Safety Snack Scanner</header>

<div class="container">

    <div class="about-box">
        <h2>About this Project</h2>
        <p>
            This tool uses a Teachable Machine image model to help identify whether a snack 
            contains nuts, does not contain nuts, or may possibly contain nuts.  
            It is designed to help people who need to be more careful around nut ingredients, 
            such as individuals with allergies or their families.
        </p>
    </div>

    <h2>How to Use</h2>
    <p>1. Hold a snack in front of your webcam.<br>
       2. Click ‚ÄúStart Scanner.‚Äù<br>
       3. Your classification will appear live below the camera.</p>

    <button onclick="init()">Start Scanner</button>

    <div id="webcam-container"></div>
    <div id="label-container"></div>

    <h2>Legend</h2>
    <div class="legend">
        <div class="legend-box">
            <div class="icon">üå∞</div>
            <div>Contains Nuts</div>
        </div>

        <div class="legend-box">
            <div class="icon">‚úîÔ∏è</div>
            <div>No Nuts</div>
        </div>

        <div class="legend-box">
            <div class="icon">‚ùì</div>
            <div>Might Contain Nuts</div>
        </div>
    </div>

</div>

<footer>Created with Teachable Machine ¬∑ Class Project</footer>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest/dist/teachablemachine-image.min.js"></script>

<script>
    const URL = "./my_model/";
    let model, webcam, labelContainer, maxPredictions;

    async function init() {
        const modelURL = URL + "model.json";
        const metadataURL = URL + "metadata.json";

        model = await tmImage.load(modelURL, metadataURL);
        maxPredictions = model.getTotalClasses();

        const flip = true;
        webcam = new tmImage.Webcam(250, 250, flip);
        await webcam.setup();
        await webcam.play();
        window.requestAnimationFrame(loop);

        document.getElementById("webcam-container").appendChild(webcam.canvas);

        labelContainer = document.getElementById("label-container");
        labelContainer.innerHTML = "";
        for (let i = 0; i < maxPredictions; i++) {
            labelContainer.appendChild(document.createElement("div"));
        }
    }

    async function loop() {
        webcam.update();
        await predict();
        window.requestAnimationFrame(loop);
    }

    async function predict() {
        const prediction = await model.predict(webcam.canvas);
        for (let i = 0; i < maxPredictions; i++) {
            labelContainer.childNodes[i].innerHTML =
                prediction[i].className + ": " + prediction[i].probability.toFixed(2);
        }
    }
</script>

</body>
</html>
